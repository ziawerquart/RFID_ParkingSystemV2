---
number headings: auto, first-level 1, max 6, skip ^skipped, _.1.1
---
1. 增加打印调试信息：
	1. 在控制台打印收发包信息，包括包类型和包内容（getID, select card, suthcheck，read，write等）
2. 修改bug：
	1. 解决弹窗的中文显示乱码问题
3. 进一步优化逻辑
	1. 用户刷卡后读取信息时
		1. 若卡中信息无效，弹窗显示“请先注册”，并进入注册逻辑
		2. 若卡中信息有效，弹窗显示“成功入场”或“成功出场”，进入计费逻辑
	2. 若在用户出场时计算余额不足，则自动进入充值界面，并提示用户“余额不足，需充值x元”，x为用户最少注册费用
---

## 1 优化流程

自己电脑实验没问题后上机测试
## 2 优化1
- [x] **优化虚拟串口** ✅ 2025-12-23
1. 减慢收发包速度
2. 启动程序后显示gui，内容包括：
	1. “模拟放卡”按钮、“收卡”按钮
	2. 显示收发包内容信息
---
- [ ] **优化逻辑**
3. [ ] 优化用户刷卡后逻辑
	1. [ ] 注册逻辑：若卡中信息无效，弹窗显示“请先注册，不要收卡”，并进入注册逻辑
		1. 注册逻辑
			1. 系统进入“注册状态”，暂停寻卡，显示弹窗，内含待填写info信息和“确认”按钮
			2. 用户点击“确认”按钮后将弹窗中的采集信息进行写入卡中
			3. 写入完成后再次读卡，从块1、2中读取info信息
				1. 若成功，则在弹窗提示“写入成功，请立即收卡”，用户方可收卡离开
				2. 若失败，则在弹窗显示“写入失败，请重新刷卡”，用户需再次刷卡或者直接离开
		2. 注意：不进行入场判断，不扣费
	2. [ ] 计费逻辑：若卡中信息有效，弹窗显示“成功入场”或“成功出场”，进入计费逻辑
		1. 若为入场
			1. 系统进入“入场状态”，弹窗显示“正在入场中，不要收卡”暂停寻卡，读入用户卡中信息
				1. 读入成功，则弹窗显示“入场成功，请收卡”
				2. 读入失败，则弹窗显示“入场失败，请重新刷卡”
			2. 
		2. 若为出场
			1. 系统进入“出场状态”，弹窗显示“正在出场中，不要收卡”暂停寻卡，并开始尝试扣费逻辑
				1. 首先读入用户余额信息
					1. 失败，则弹窗显示“出场失败，请重新刷卡”
				2. 然后尝试扣费
					1. 余额不足，弹窗显示“余额不足，请先充值”，并进入充值逻辑
					2. 余额充足，则进行写入新余额信息
						1. 写入成功，则弹窗显示“出场成功，请收卡”
						2. 写入失败，则弹窗显示“出场失败，请重新刷卡”
4. [ ] 优化充值逻辑：用户点击充值按钮后
	1. 停止读卡流程，并提示用户不准拿开卡。
	2. 点击按钮后弹出信息输入框，包括金额输入框用户输入后点击确认后继续写入，若写入失败则提示。
	3. 写入后再读取一遍进行确认无误后在主界面显示信息
---
- [ ] **添加代码健壮程度**
1. 注册过程
	1. 用户注册点击确认按钮后，若用户拿开卡
2. 充值、进场、入场过程中若拿开卡，重置卡状态
## 3 优化2
**注册逻辑优化**
用户在点击确认按钮后，弹窗显示“正在写入，不要收卡”
在写入完成后再次读取确认无误后才弹窗显示“注册成功，请收卡”

**寻卡逻辑**
解决若不先放卡，就无法寻到卡的问题
## 4 final优化——优化gui
1. 优化信息框显示bug
	- 用户名只显示有效部分
2. 删除与停车系统无关的ui部分
